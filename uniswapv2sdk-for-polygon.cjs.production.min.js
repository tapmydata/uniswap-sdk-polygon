"use strict";function _interopDefault(ex){return ex&&"object"==typeof ex&&"default"in ex?ex.default:ex}Object.defineProperty(exports,"__esModule",{value:!0});var _SOLIDITY_TYPE_MAXIMA,SolidityType,JSBI=_interopDefault(require("jsbi")),invariant=_interopDefault(require("tiny-invariant")),warning=_interopDefault(require("tiny-warning")),address=require("@ethersproject/address"),_Big=_interopDefault(require("big.js")),toFormat=_interopDefault(require("toformat")),_Decimal=_interopDefault(require("decimal.js-light")),solidity=require("@ethersproject/solidity"),contracts=require("@ethersproject/contracts"),networks=require("@ethersproject/networks"),providers=require("@ethersproject/providers"),IUniswapV2Pair=_interopDefault(require("@uniswap/v2-core/build/IUniswapV2Pair.json")),FACTORY_ADDRESS=(!function(ChainId){ChainId[ChainId.MUMBAI=80001]="MUMBAI",ChainId[ChainId.MATIC=137]="MATIC"}(exports.ChainId||(exports.ChainId={})),!function(TradeType){TradeType[TradeType.EXACT_INPUT=0]="EXACT_INPUT",TradeType[TradeType.EXACT_OUTPUT=1]="EXACT_OUTPUT"}(exports.TradeType||(exports.TradeType={})),!function(Rounding){Rounding[Rounding.ROUND_DOWN=0]="ROUND_DOWN",Rounding[Rounding.ROUND_HALF_UP=1]="ROUND_HALF_UP",Rounding[Rounding.ROUND_UP=2]="ROUND_UP"}(exports.Rounding||(exports.Rounding={})),"0x867a7683cd7917a4ee958a8dc44b8587e80db307"),INIT_CODE_HASH="0x96e8ac4277198ff8b6f785478aa9a39f403cb768dd02cbee326c3e7da348845f",MINIMUM_LIQUIDITY=JSBI.BigInt(1e3),ZERO=JSBI.BigInt(0),ONE=JSBI.BigInt(1),TWO=JSBI.BigInt(2),THREE=JSBI.BigInt(3),FIVE=JSBI.BigInt(5),TEN=JSBI.BigInt(10),_100=JSBI.BigInt(100),_997=JSBI.BigInt(997),_1000=JSBI.BigInt(1e3),SOLIDITY_TYPE_MAXIMA=(!function(SolidityType){SolidityType.uint8="uint8",SolidityType.uint256="uint256"}(SolidityType=SolidityType||{}),(_SOLIDITY_TYPE_MAXIMA={})[SolidityType.uint8]=JSBI.BigInt("0xff"),_SOLIDITY_TYPE_MAXIMA[SolidityType.uint256]=JSBI.BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),_SOLIDITY_TYPE_MAXIMA);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var key,source=arguments[i];for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype),(subClass.prototype.constructor=subClass).__proto__=superClass}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _construct(Parent,args,Class){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(Parent,args,Class){var a=[null];a.push.apply(a,args);args=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(args,Class.prototype),args}).apply(null,arguments)}function _isNativeFunction(fn){return-1!==Function.toString.call(fn).indexOf("[native code]")}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(Class){if(null===Class||!_isNativeFunction(Class))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)})(Class)}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Map"===(n="Object"===n&&o.constructor?o.constructor.name:n)||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _createForOfIteratorHelperLoose(o,allowArrayLike){var it,i;if("undefined"!=typeof Symbol&&null!=o[Symbol.iterator])return(it=o[Symbol.iterator]()).next.bind(it);if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length)return it&&(o=it),i=0,function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var CAN_SET_PROTOTYPE="setPrototypeOf"in Object,InsufficientReservesError=function(_Error){function InsufficientReservesError(){var _this=_Error.call(this)||this;return _this.isInsufficientReservesError=!0,_this.name=_this.constructor.name,CAN_SET_PROTOTYPE&&Object.setPrototypeOf(_assertThisInitialized(_this),(this instanceof InsufficientReservesError?this.constructor:void 0).prototype),_this}return _inheritsLoose(InsufficientReservesError,_Error),InsufficientReservesError}(_wrapNativeSuper(Error)),InsufficientInputAmountError=function(_Error2){function InsufficientInputAmountError(){var _this2=_Error2.call(this)||this;return _this2.isInsufficientInputAmountError=!0,_this2.name=_this2.constructor.name,CAN_SET_PROTOTYPE&&Object.setPrototypeOf(_assertThisInitialized(_this2),(this instanceof InsufficientInputAmountError?this.constructor:void 0).prototype),_this2}return _inheritsLoose(InsufficientInputAmountError,_Error2),InsufficientInputAmountError}(_wrapNativeSuper(Error));function validateSolidityTypeInstance(value,solidityType){JSBI.greaterThanOrEqual(value,ZERO)||invariant(!1,value+" is not a "+solidityType+"."),JSBI.lessThanOrEqual(value,SOLIDITY_TYPE_MAXIMA[solidityType])||invariant(!1,value+" is not a "+solidityType+".")}function validateAndParseAddress(address$1){try{var checksummedAddress=address.getAddress(address$1);return warning(address$1===checksummedAddress,address$1+" is not checksummed."),checksummedAddress}catch(error){invariant(!1,address$1+" is not a valid address.")}}function parseBigintIsh(bigintIsh){return bigintIsh instanceof JSBI?bigintIsh:"bigint"==typeof bigintIsh?JSBI.BigInt(bigintIsh.toString()):JSBI.BigInt(bigintIsh)}function sqrt(y){validateSolidityTypeInstance(y,SolidityType.uint256);var x,z=ZERO;if(JSBI.greaterThan(y,THREE))for(x=JSBI.add(JSBI.divide(z=y,TWO),ONE);JSBI.lessThan(x,z);)z=x,x=JSBI.divide(JSBI.add(JSBI.divide(y,x),x),TWO);else JSBI.notEqual(y,ZERO)&&(z=ONE);return z}function sortedInsert(items,add,maxSize,comparator){if(0<maxSize||invariant(!1,"MAX_SIZE_ZERO"),items.length<=maxSize||invariant(!1,"ITEMS_SIZE"),0===items.length)return items.push(add),null;maxSize=items.length===maxSize;if(maxSize&&comparator(items[items.length-1],add)<=0)return add;for(var lo=0,hi=items.length;lo<hi;){var mid=lo+hi>>>1;comparator(items[mid],add)<=0?lo=1+mid:hi=mid}return items.splice(lo,0,add),maxSize?items.pop():null}var _WETH,Currency=function(decimals,symbol,name){validateSolidityTypeInstance(JSBI.BigInt(decimals),SolidityType.uint8),this.decimals=decimals,this.symbol=symbol,this.name=name},ETHER=(Currency.ETHER=new Currency(18,"MATIC","MATIC"),Currency.ETHER),Token=function(_Currency){function Token(chainId,address,decimals,symbol,name){decimals=_Currency.call(this,decimals,symbol,name)||this;return decimals.chainId=chainId,decimals.address=validateAndParseAddress(address),decimals}_inheritsLoose(Token,_Currency);var _proto=Token.prototype;return _proto.equals=function(other){return this===other||this.chainId===other.chainId&&this.address===other.address},_proto.sortsBefore=function(other){return this.chainId!==other.chainId&&invariant(!1,"CHAIN_IDS"),this.address===other.address&&invariant(!1,"ADDRESSES"),this.address.toLowerCase()<other.address.toLowerCase()},Token}(Currency);function currencyEquals(currencyA,currencyB){return currencyA instanceof Token&&currencyB instanceof Token?currencyA.equals(currencyB):!(currencyA instanceof Token)&&(!(currencyB instanceof Token)&&currencyA===currencyB)}(_WETH={})[exports.ChainId.MUMBAI]=new Token(exports.ChainId.MUMBAI,"0x9c3C9283D3e44854697Cd22D3Faa240Cfb032889",18,"WMATIC","Wrapped Matic"),_WETH[exports.ChainId.MATIC]=new Token(exports.ChainId.MATIC,"0x0f5e15e906861cacd1b59c146af3975dfd93ef9a",18,"WMATIC","Wrapped Matic");var _toSignificantRoundin,_toFixedRounding,WETH=_WETH,Decimal=toFormat(_Decimal),Big=toFormat(_Big),toSignificantRounding=((_toSignificantRoundin={})[exports.Rounding.ROUND_DOWN]=Decimal.ROUND_DOWN,_toSignificantRoundin[exports.Rounding.ROUND_HALF_UP]=Decimal.ROUND_HALF_UP,_toSignificantRoundin[exports.Rounding.ROUND_UP]=Decimal.ROUND_UP,_toSignificantRoundin),toFixedRounding=((_toFixedRounding={})[exports.Rounding.ROUND_DOWN]=0,_toFixedRounding[exports.Rounding.ROUND_HALF_UP]=1,_toFixedRounding[exports.Rounding.ROUND_UP]=3,_toFixedRounding),Fraction=function(){function Fraction(numerator,denominator){void 0===denominator&&(denominator=ONE),this.numerator=parseBigintIsh(numerator),this.denominator=parseBigintIsh(denominator)}var _proto=Fraction.prototype;return _proto.invert=function(){return new Fraction(this.denominator,this.numerator)},_proto.add=function(other){other=other instanceof Fraction?other:new Fraction(parseBigintIsh(other));return JSBI.equal(this.denominator,other.denominator)?new Fraction(JSBI.add(this.numerator,other.numerator),this.denominator):new Fraction(JSBI.add(JSBI.multiply(this.numerator,other.denominator),JSBI.multiply(other.numerator,this.denominator)),JSBI.multiply(this.denominator,other.denominator))},_proto.subtract=function(other){other=other instanceof Fraction?other:new Fraction(parseBigintIsh(other));return JSBI.equal(this.denominator,other.denominator)?new Fraction(JSBI.subtract(this.numerator,other.numerator),this.denominator):new Fraction(JSBI.subtract(JSBI.multiply(this.numerator,other.denominator),JSBI.multiply(other.numerator,this.denominator)),JSBI.multiply(this.denominator,other.denominator))},_proto.lessThan=function(other){other=other instanceof Fraction?other:new Fraction(parseBigintIsh(other));return JSBI.lessThan(JSBI.multiply(this.numerator,other.denominator),JSBI.multiply(other.numerator,this.denominator))},_proto.equalTo=function(other){other=other instanceof Fraction?other:new Fraction(parseBigintIsh(other));return JSBI.equal(JSBI.multiply(this.numerator,other.denominator),JSBI.multiply(other.numerator,this.denominator))},_proto.greaterThan=function(other){other=other instanceof Fraction?other:new Fraction(parseBigintIsh(other));return JSBI.greaterThan(JSBI.multiply(this.numerator,other.denominator),JSBI.multiply(other.numerator,this.denominator))},_proto.multiply=function(other){other=other instanceof Fraction?other:new Fraction(parseBigintIsh(other));return new Fraction(JSBI.multiply(this.numerator,other.numerator),JSBI.multiply(this.denominator,other.denominator))},_proto.divide=function(other){other=other instanceof Fraction?other:new Fraction(parseBigintIsh(other));return new Fraction(JSBI.multiply(this.numerator,other.denominator),JSBI.multiply(this.denominator,other.numerator))},_proto.toSignificant=function(significantDigits,format,rounding){void 0===format&&(format={groupSeparator:""}),void 0===rounding&&(rounding=exports.Rounding.ROUND_HALF_UP),Number.isInteger(significantDigits)||invariant(!1,significantDigits+" is not an integer."),0<significantDigits||invariant(!1,significantDigits+" is not positive."),Decimal.set({precision:significantDigits+1,rounding:toSignificantRounding[rounding]});rounding=new Decimal(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(significantDigits);return rounding.toFormat(rounding.decimalPlaces(),format)},_proto.toFixed=function(decimalPlaces,format,rounding){return void 0===format&&(format={groupSeparator:""}),void 0===rounding&&(rounding=exports.Rounding.ROUND_HALF_UP),Number.isInteger(decimalPlaces)||invariant(!1,decimalPlaces+" is not an integer."),0<=decimalPlaces||invariant(!1,decimalPlaces+" is negative."),Big.DP=decimalPlaces,Big.RM=toFixedRounding[rounding],new Big(this.numerator.toString()).div(this.denominator.toString()).toFormat(decimalPlaces,format)},_createClass(Fraction,[{key:"quotient",get:function(){return JSBI.divide(this.numerator,this.denominator)}},{key:"remainder",get:function(){return new Fraction(JSBI.remainder(this.numerator,this.denominator),this.denominator)}}]),Fraction}(),Big$1=toFormat(_Big),CurrencyAmount=function(_Fraction){function CurrencyAmount(currency,amount){var amount=parseBigintIsh(amount);return validateSolidityTypeInstance(amount,SolidityType.uint256),(amount=_Fraction.call(this,amount,JSBI.exponentiate(TEN,JSBI.BigInt(currency.decimals)))||this).currency=currency,amount}_inheritsLoose(CurrencyAmount,_Fraction),CurrencyAmount.ether=function(amount){return new CurrencyAmount(ETHER,amount)};var _proto=CurrencyAmount.prototype;return _proto.add=function(other){return currencyEquals(this.currency,other.currency)||invariant(!1,"TOKEN"),new CurrencyAmount(this.currency,JSBI.add(this.raw,other.raw))},_proto.subtract=function(other){return currencyEquals(this.currency,other.currency)||invariant(!1,"TOKEN"),new CurrencyAmount(this.currency,JSBI.subtract(this.raw,other.raw))},_proto.toSignificant=function(significantDigits,format,rounding){return void 0===significantDigits&&(significantDigits=6),void 0===rounding&&(rounding=exports.Rounding.ROUND_DOWN),_Fraction.prototype.toSignificant.call(this,significantDigits,format,rounding)},_proto.toFixed=function(decimalPlaces,format,rounding){return void 0===decimalPlaces&&(decimalPlaces=this.currency.decimals),void 0===rounding&&(rounding=exports.Rounding.ROUND_DOWN),decimalPlaces<=this.currency.decimals||invariant(!1,"DECIMALS"),_Fraction.prototype.toFixed.call(this,decimalPlaces,format,rounding)},_proto.toExact=function(format){return void 0===format&&(format={groupSeparator:""}),Big$1.DP=this.currency.decimals,new Big$1(this.numerator.toString()).div(this.denominator.toString()).toFormat(format)},_createClass(CurrencyAmount,[{key:"raw",get:function(){return this.numerator}}]),CurrencyAmount}(Fraction),TokenAmount=function(_CurrencyAmount){function TokenAmount(token,amount){amount=_CurrencyAmount.call(this,token,amount)||this;return amount.token=token,amount}_inheritsLoose(TokenAmount,_CurrencyAmount);var _proto=TokenAmount.prototype;return _proto.add=function(other){return this.token.equals(other.token)||invariant(!1,"TOKEN"),new TokenAmount(this.token,JSBI.add(this.raw,other.raw))},_proto.subtract=function(other){return this.token.equals(other.token)||invariant(!1,"TOKEN"),new TokenAmount(this.token,JSBI.subtract(this.raw,other.raw))},TokenAmount}(CurrencyAmount),Price=function(_Fraction){function Price(baseCurrency,quoteCurrency,denominator,numerator){numerator=_Fraction.call(this,numerator,denominator)||this;return numerator.baseCurrency=baseCurrency,numerator.quoteCurrency=quoteCurrency,numerator.scalar=new Fraction(JSBI.exponentiate(TEN,JSBI.BigInt(baseCurrency.decimals)),JSBI.exponentiate(TEN,JSBI.BigInt(quoteCurrency.decimals))),numerator}_inheritsLoose(Price,_Fraction),Price.fromRoute=function(route){for(var prices=[],_iterator=_createForOfIteratorHelperLoose(route.pairs.entries());!(_step=_iterator()).done;){var _step=_step.value,i=_step[0],_step=_step[1];prices.push(route.path[i].equals(_step.token0)?new Price(_step.reserve0.currency,_step.reserve1.currency,_step.reserve0.raw,_step.reserve1.raw):new Price(_step.reserve1.currency,_step.reserve0.currency,_step.reserve1.raw,_step.reserve0.raw))}return prices.slice(1).reduce(function(accumulator,currentValue){return accumulator.multiply(currentValue)},prices[0])};var _proto=Price.prototype;return _proto.invert=function(){return new Price(this.quoteCurrency,this.baseCurrency,this.numerator,this.denominator)},_proto.multiply=function(other){currencyEquals(this.quoteCurrency,other.baseCurrency)||invariant(!1,"TOKEN");var fraction=_Fraction.prototype.multiply.call(this,other);return new Price(this.baseCurrency,other.quoteCurrency,fraction.denominator,fraction.numerator)},_proto.quote=function(currencyAmount){return currencyEquals(currencyAmount.currency,this.baseCurrency)||invariant(!1,"TOKEN"),this.quoteCurrency instanceof Token?new TokenAmount(this.quoteCurrency,_Fraction.prototype.multiply.call(this,currencyAmount.raw).quotient):CurrencyAmount.ether(_Fraction.prototype.multiply.call(this,currencyAmount.raw).quotient)},_proto.toSignificant=function(significantDigits,format,rounding){return this.adjusted.toSignificant(significantDigits=void 0===significantDigits?6:significantDigits,format,rounding)},_proto.toFixed=function(decimalPlaces,format,rounding){return this.adjusted.toFixed(decimalPlaces=void 0===decimalPlaces?4:decimalPlaces,format,rounding)},_createClass(Price,[{key:"raw",get:function(){return new Fraction(this.numerator,this.denominator)}},{key:"adjusted",get:function(){return _Fraction.prototype.multiply.call(this,this.scalar)}}]),Price}(Fraction),PAIR_ADDRESS_CACHE={},Pair=function(){function Pair(tokenAmountA,tokenAmountB){tokenAmountB=tokenAmountA.token.sortsBefore(tokenAmountB.token)?[tokenAmountA,tokenAmountB]:[tokenAmountB,tokenAmountA];this.liquidityToken=new Token(tokenAmountB[0].token.chainId,"0x7c1e12b3c78cdcbc7d3c0c1d299e7a2216d10105",18,"SLP","SushiSwap LP"),this.tokenAmounts=tokenAmountB}Pair.getAddress=function(tokenA,tokenB){var _PAIR_ADDRESS_CACHE2,tokenB=tokenA.sortsBefore(tokenB)?[tokenA,tokenB]:[tokenB,tokenA];return(PAIR_ADDRESS_CACHE=void 0===(null==(tokenA=PAIR_ADDRESS_CACHE)||null==(tokenA=tokenA[tokenB[0].address])?void 0:tokenA[tokenB[1].address])?_extends({},PAIR_ADDRESS_CACHE,((tokenA={})[tokenB[0].address]=_extends({},null==(_PAIR_ADDRESS_CACHE2=PAIR_ADDRESS_CACHE)?void 0:_PAIR_ADDRESS_CACHE2[tokenB[0].address],((_PAIR_ADDRESS_CACHE2={})[tokenB[1].address]=address.getCreate2Address(FACTORY_ADDRESS,solidity.keccak256(["bytes"],[solidity.pack(["address","address"],[tokenB[0].address,tokenB[1].address])]),INIT_CODE_HASH),_PAIR_ADDRESS_CACHE2)),tokenA)):PAIR_ADDRESS_CACHE)[tokenB[0].address][tokenB[1].address]};var _proto=Pair.prototype;return _proto.involvesToken=function(token){return token.equals(this.token0)||token.equals(this.token1)},_proto.priceOf=function(token){return this.involvesToken(token)||invariant(!1,"TOKEN"),token.equals(this.token0)?this.token0Price:this.token1Price},_proto.reserveOf=function(token){return this.involvesToken(token)||invariant(!1,"TOKEN"),token.equals(this.token0)?this.reserve0:this.reserve1},_proto.getOutputAmount=function(inputAmount){if(this.involvesToken(inputAmount.token)||invariant(!1,"TOKEN"),JSBI.equal(this.reserve0.raw,ZERO)||JSBI.equal(this.reserve1.raw,ZERO))throw new InsufficientReservesError;var inputReserve=this.reserveOf(inputAmount.token),outputReserve=this.reserveOf(inputAmount.token.equals(this.token0)?this.token1:this.token0),inputAmountWithFee=JSBI.multiply(inputAmount.raw,_997),numerator=JSBI.multiply(inputAmountWithFee,outputReserve.raw),inputAmountWithFee=JSBI.add(JSBI.multiply(inputReserve.raw,_1000),inputAmountWithFee),numerator=new TokenAmount(inputAmount.token.equals(this.token0)?this.token1:this.token0,JSBI.divide(numerator,inputAmountWithFee));if(JSBI.equal(numerator.raw,ZERO))throw new InsufficientInputAmountError;return[numerator,new Pair(inputReserve.add(inputAmount),outputReserve.subtract(numerator))]},_proto.getInputAmount=function(outputAmount){if(this.involvesToken(outputAmount.token)||invariant(!1,"TOKEN"),JSBI.equal(this.reserve0.raw,ZERO)||JSBI.equal(this.reserve1.raw,ZERO)||JSBI.greaterThanOrEqual(outputAmount.raw,this.reserveOf(outputAmount.token).raw))throw new InsufficientReservesError;var outputReserve=this.reserveOf(outputAmount.token),inputReserve=this.reserveOf(outputAmount.token.equals(this.token0)?this.token1:this.token0),numerator=JSBI.multiply(JSBI.multiply(inputReserve.raw,outputAmount.raw),_1000),denominator=JSBI.multiply(JSBI.subtract(outputReserve.raw,outputAmount.raw),_997),numerator=new TokenAmount(outputAmount.token.equals(this.token0)?this.token1:this.token0,JSBI.add(JSBI.divide(numerator,denominator),ONE));return[numerator,new Pair(inputReserve.add(numerator),outputReserve.subtract(outputAmount))]},_proto.getLiquidityMinted=function(totalSupply,tokenAmountA,tokenAmountB){totalSupply.token.equals(this.liquidityToken)||invariant(!1,"LIQUIDITY");var tokenAmountB=tokenAmountA.token.sortsBefore(tokenAmountB.token)?[tokenAmountA,tokenAmountB]:[tokenAmountB,tokenAmountA];if(tokenAmountB[0].token.equals(this.token0)&&tokenAmountB[1].token.equals(this.token1)||invariant(!1,"TOKEN"),totalSupply=JSBI.equal(totalSupply.raw,ZERO)?JSBI.subtract(sqrt(JSBI.multiply(tokenAmountB[0].raw,tokenAmountB[1].raw)),MINIMUM_LIQUIDITY):(tokenAmountA=JSBI.divide(JSBI.multiply(tokenAmountB[0].raw,totalSupply.raw),this.reserve0.raw),tokenAmountB=JSBI.divide(JSBI.multiply(tokenAmountB[1].raw,totalSupply.raw),this.reserve1.raw),JSBI.lessThanOrEqual(tokenAmountA,tokenAmountB)?tokenAmountA:tokenAmountB),JSBI.greaterThan(totalSupply,ZERO))return new TokenAmount(this.liquidityToken,totalSupply);throw new InsufficientInputAmountError},_proto.getLiquidityValue=function(token,totalSupply,liquidity,feeOn,kLast){var numerator;return void 0===feeOn&&(feeOn=!1),this.involvesToken(token)||invariant(!1,"TOKEN"),totalSupply.token.equals(this.liquidityToken)||invariant(!1,"TOTAL_SUPPLY"),liquidity.token.equals(this.liquidityToken)||invariant(!1,"LIQUIDITY"),JSBI.lessThanOrEqual(liquidity.raw,totalSupply.raw)||invariant(!1,"LIQUIDITY"),numerator=feeOn?(kLast||invariant(!1,"K_LAST"),feeOn=parseBigintIsh(kLast),JSBI.equal(feeOn,ZERO)?totalSupply:(kLast=sqrt(JSBI.multiply(this.reserve0.raw,this.reserve1.raw)),feeOn=sqrt(feeOn),JSBI.greaterThan(kLast,feeOn)?(numerator=JSBI.multiply(totalSupply.raw,JSBI.subtract(kLast,feeOn)),kLast=JSBI.add(JSBI.multiply(kLast,FIVE),feeOn),feeOn=JSBI.divide(numerator,kLast),totalSupply.add(new TokenAmount(this.liquidityToken,feeOn))):totalSupply)):totalSupply,new TokenAmount(token,JSBI.divide(JSBI.multiply(liquidity.raw,this.reserveOf(token).raw),numerator.raw))},_createClass(Pair,[{key:"token0Price",get:function(){return new Price(this.token0,this.token1,this.tokenAmounts[0].raw,this.tokenAmounts[1].raw)}},{key:"token1Price",get:function(){return new Price(this.token1,this.token0,this.tokenAmounts[1].raw,this.tokenAmounts[0].raw)}},{key:"chainId",get:function(){return this.token0.chainId}},{key:"token0",get:function(){return this.tokenAmounts[0].token}},{key:"token1",get:function(){return this.tokenAmounts[1].token}},{key:"reserve0",get:function(){return this.tokenAmounts[0]}},{key:"reserve1",get:function(){return this.tokenAmounts[1]}}]),Pair}(),Route=function(){function Route(pairs,input,output){0<pairs.length||invariant(!1,"PAIRS"),pairs.every(function(pair){return pair.chainId===pairs[0].chainId})||invariant(!1,"CHAIN_IDS"),input instanceof Token&&pairs[0].involvesToken(input)||input===ETHER&&pairs[0].involvesToken(WETH[pairs[0].chainId])||invariant(!1,"INPUT"),void 0===output||output instanceof Token&&pairs[pairs.length-1].involvesToken(output)||output===ETHER&&pairs[pairs.length-1].involvesToken(WETH[pairs[0].chainId])||invariant(!1,"OUTPUT");for(var path=[input instanceof Token?input:WETH[pairs[0].chainId]],_iterator=_createForOfIteratorHelperLoose(pairs.entries());!(_step=_iterator()).done;){var _step=_step.value,i=_step[0],_step=_step[1],i=path[i],i=(i.equals(_step.token0)||i.equals(_step.token1)||invariant(!1,"PATH"),i.equals(_step.token0)?_step.token1:_step.token0);path.push(i)}this.pairs=pairs,this.path=path,this.midPrice=Price.fromRoute(this),this.input=input,this.output=null!=output?output:path[path.length-1]}return _createClass(Route,[{key:"chainId",get:function(){return this.pairs[0].chainId}}]),Route}(),_100_PERCENT=new Fraction(_100),Percent=function(_Fraction){function Percent(){return _Fraction.apply(this,arguments)||this}_inheritsLoose(Percent,_Fraction);var _proto=Percent.prototype;return _proto.toSignificant=function(significantDigits,format,rounding){return void 0===significantDigits&&(significantDigits=5),this.multiply(_100_PERCENT).toSignificant(significantDigits,format,rounding)},_proto.toFixed=function(decimalPlaces,format,rounding){return void 0===decimalPlaces&&(decimalPlaces=2),this.multiply(_100_PERCENT).toFixed(decimalPlaces,format,rounding)},Percent}(Fraction);function computePriceImpact(midPrice,inputAmount,outputAmount){midPrice=midPrice.raw.multiply(inputAmount.raw),inputAmount=midPrice.subtract(outputAmount.raw).divide(midPrice);return new Percent(inputAmount.numerator,inputAmount.denominator)}function inputOutputComparator(a,b){return currencyEquals(a.inputAmount.currency,b.inputAmount.currency)||invariant(!1,"INPUT_CURRENCY"),currencyEquals(a.outputAmount.currency,b.outputAmount.currency)||invariant(!1,"OUTPUT_CURRENCY"),a.outputAmount.equalTo(b.outputAmount)?a.inputAmount.equalTo(b.inputAmount)?0:a.inputAmount.lessThan(b.inputAmount)?-1:1:a.outputAmount.lessThan(b.outputAmount)?1:-1}function tradeComparator(a,b){var ioComp=inputOutputComparator(a,b);return 0!==ioComp?ioComp:a.priceImpact.lessThan(b.priceImpact)?-1:a.priceImpact.greaterThan(b.priceImpact)?1:a.route.path.length-b.route.path.length}function wrappedAmount(currencyAmount,chainId){return currencyAmount instanceof TokenAmount?currencyAmount:currencyAmount.currency===ETHER?new TokenAmount(WETH[chainId],currencyAmount.raw):void invariant(!1,"CURRENCY")}function wrappedCurrency(currency,chainId){return currency instanceof Token?currency:currency===ETHER?WETH[chainId]:void invariant(!1,"CURRENCY")}var Trade=function(){function Trade(route,amount,tradeType){var amounts=new Array(route.path.length),nextPairs=new Array(route.pairs.length);if(tradeType===exports.TradeType.EXACT_INPUT){currencyEquals(amount.currency,route.input)||invariant(!1,"INPUT"),amounts[0]=wrappedAmount(amount,route.chainId);for(var i=0;i<route.path.length-1;i++){var _pair$getOutputAmount=route.pairs[i].getOutputAmount(amounts[i]),outputAmount=_pair$getOutputAmount[0],_pair$getOutputAmount=_pair$getOutputAmount[1];amounts[i+1]=outputAmount,nextPairs[i]=_pair$getOutputAmount}}else{currencyEquals(amount.currency,route.output)||invariant(!1,"OUTPUT"),amounts[amounts.length-1]=wrappedAmount(amount,route.chainId);for(var _i=route.path.length-1;0<_i;_i--){var _pair$getInputAmount=route.pairs[_i-1].getInputAmount(amounts[_i]),inputAmount=_pair$getInputAmount[0],_pair$getInputAmount=_pair$getInputAmount[1];amounts[_i-1]=inputAmount,nextPairs[_i-1]=_pair$getInputAmount}}this.route=route,this.tradeType=tradeType,this.inputAmount=tradeType===exports.TradeType.EXACT_INPUT?amount:route.input===ETHER?CurrencyAmount.ether(amounts[0].raw):amounts[0],this.outputAmount=tradeType===exports.TradeType.EXACT_OUTPUT?amount:route.output===ETHER?CurrencyAmount.ether(amounts[amounts.length-1].raw):amounts[amounts.length-1],this.executionPrice=new Price(this.inputAmount.currency,this.outputAmount.currency,this.inputAmount.raw,this.outputAmount.raw),this.nextMidPrice=Price.fromRoute(new Route(nextPairs,route.input)),this.priceImpact=computePriceImpact(route.midPrice,this.inputAmount,this.outputAmount)}Trade.exactIn=function(route,amountIn){return new Trade(route,amountIn,exports.TradeType.EXACT_INPUT)},Trade.exactOut=function(route,amountOut){return new Trade(route,amountOut,exports.TradeType.EXACT_OUTPUT)};var _proto=Trade.prototype;return _proto.minimumAmountOut=function(slippageTolerance){return slippageTolerance.lessThan(ZERO)&&invariant(!1,"SLIPPAGE_TOLERANCE"),this.tradeType===exports.TradeType.EXACT_OUTPUT?this.outputAmount:(slippageTolerance=new Fraction(ONE).add(slippageTolerance).invert().multiply(this.outputAmount.raw).quotient,this.outputAmount instanceof TokenAmount?new TokenAmount(this.outputAmount.token,slippageTolerance):CurrencyAmount.ether(slippageTolerance))},_proto.maximumAmountIn=function(slippageTolerance){return slippageTolerance.lessThan(ZERO)&&invariant(!1,"SLIPPAGE_TOLERANCE"),this.tradeType===exports.TradeType.EXACT_INPUT?this.inputAmount:(slippageTolerance=new Fraction(ONE).add(slippageTolerance).multiply(this.inputAmount.raw).quotient,this.inputAmount instanceof TokenAmount?new TokenAmount(this.inputAmount.token,slippageTolerance):CurrencyAmount.ether(slippageTolerance))},Trade.bestTradeExactIn=function(pairs,currencyAmountIn,currencyOut,_temp,currentPairs,originalAmountIn,bestTrades){for(var _temp=void 0===_temp?{}:_temp,_ref$maxNumResults=_temp.maxNumResults,maxNumResults=void 0===_ref$maxNumResults?3:_ref$maxNumResults,_ref$maxNumResults=_temp.maxHops,maxHops=void 0===_ref$maxNumResults?3:_ref$maxNumResults,_temp=(void 0===currentPairs&&(currentPairs=[]),void 0===originalAmountIn&&(originalAmountIn=currencyAmountIn),void 0===bestTrades&&(bestTrades=[]),0<pairs.length||invariant(!1,"PAIRS"),0<maxHops||invariant(!1,"MAX_HOPS"),originalAmountIn===currencyAmountIn||0<currentPairs.length||invariant(!1,"INVALID_RECURSION"),currencyAmountIn instanceof TokenAmount?currencyAmountIn.token.chainId:currencyOut instanceof Token?currencyOut.chainId:void 0),amountIn=(void 0===_temp&&invariant(!1,"CHAIN_ID"),wrappedAmount(currencyAmountIn,_temp)),tokenOut=wrappedCurrency(currencyOut,_temp),i=0;i<pairs.length;i++){var pair=pairs[i];if((pair.token0.equals(amountIn.token)||pair.token1.equals(amountIn.token))&&(!pair.reserve0.equalTo(ZERO)&&!pair.reserve1.equalTo(ZERO))){var pairsExcludingThisPair,amountOut=void 0;try{amountOut=pair.getOutputAmount(amountIn)[0]}catch(error){if(error.isInsufficientInputAmountError)continue;throw error}amountOut.token.equals(tokenOut)?sortedInsert(bestTrades,new Trade(new Route([].concat(currentPairs,[pair]),originalAmountIn.currency,currencyOut),originalAmountIn,exports.TradeType.EXACT_INPUT),maxNumResults,tradeComparator):1<maxHops&&1<pairs.length&&(pairsExcludingThisPair=pairs.slice(0,i).concat(pairs.slice(i+1,pairs.length)),Trade.bestTradeExactIn(pairsExcludingThisPair,amountOut,currencyOut,{maxNumResults:maxNumResults,maxHops:maxHops-1},[].concat(currentPairs,[pair]),originalAmountIn,bestTrades))}}return bestTrades},Trade.bestTradeExactOut=function(pairs,currencyIn,currencyAmountOut,_temp2,currentPairs,originalAmountOut,bestTrades){for(var _temp2=void 0===_temp2?{}:_temp2,_ref2$maxNumResults=_temp2.maxNumResults,maxNumResults=void 0===_ref2$maxNumResults?3:_ref2$maxNumResults,_ref2$maxNumResults=_temp2.maxHops,maxHops=void 0===_ref2$maxNumResults?3:_ref2$maxNumResults,_temp2=(void 0===currentPairs&&(currentPairs=[]),void 0===originalAmountOut&&(originalAmountOut=currencyAmountOut),void 0===bestTrades&&(bestTrades=[]),0<pairs.length||invariant(!1,"PAIRS"),0<maxHops||invariant(!1,"MAX_HOPS"),originalAmountOut===currencyAmountOut||0<currentPairs.length||invariant(!1,"INVALID_RECURSION"),currencyAmountOut instanceof TokenAmount?currencyAmountOut.token.chainId:currencyIn instanceof Token?currencyIn.chainId:void 0),amountOut=(void 0===_temp2&&invariant(!1,"CHAIN_ID"),wrappedAmount(currencyAmountOut,_temp2)),tokenIn=wrappedCurrency(currencyIn,_temp2),i=0;i<pairs.length;i++){var pair=pairs[i];if((pair.token0.equals(amountOut.token)||pair.token1.equals(amountOut.token))&&(!pair.reserve0.equalTo(ZERO)&&!pair.reserve1.equalTo(ZERO))){var pairsExcludingThisPair,amountIn=void 0;try{amountIn=pair.getInputAmount(amountOut)[0]}catch(error){if(error.isInsufficientReservesError)continue;throw error}amountIn.token.equals(tokenIn)?sortedInsert(bestTrades,new Trade(new Route([pair].concat(currentPairs),currencyIn,originalAmountOut.currency),originalAmountOut,exports.TradeType.EXACT_OUTPUT),maxNumResults,tradeComparator):1<maxHops&&1<pairs.length&&(pairsExcludingThisPair=pairs.slice(0,i).concat(pairs.slice(i+1,pairs.length)),Trade.bestTradeExactOut(pairsExcludingThisPair,currencyIn,amountIn,{maxNumResults:maxNumResults,maxHops:maxHops-1},[pair].concat(currentPairs),originalAmountOut,bestTrades))}}return bestTrades},Trade}();function toHex(currencyAmount){return"0x"+currencyAmount.raw.toString(16)}var _TOKEN_DECIMALS_CACHE,ZERO_HEX="0x0",Router=function(){function Router(){}return Router.swapCallParameters=function(trade,options){var methodName,args,value,etherIn=trade.inputAmount.currency===ETHER,etherOut=trade.outputAmount.currency===ETHER,to=(etherIn&&etherOut&&invariant(!1,"ETHER_IN_OUT"),"ttl"in options&&!(0<options.ttl)&&invariant(!1,"TTL"),validateAndParseAddress(options.recipient)),amountIn=toHex(trade.maximumAmountIn(options.allowedSlippage)),amountOut=toHex(trade.minimumAmountOut(options.allowedSlippage)),path=trade.route.path.map(function(token){return token.address}),deadline="ttl"in options?"0x"+(Math.floor((new Date).getTime()/1e3)+options.ttl).toString(16):"0x"+options.deadline.toString(16),useFeeOnTransfer=Boolean(options.feeOnTransfer);switch(trade.tradeType){case exports.TradeType.EXACT_INPUT:value=etherIn?(methodName=useFeeOnTransfer?"swapExactETHForTokensSupportingFeeOnTransferTokens":"swapExactETHForTokens",args=[amountOut,path,to,deadline],amountIn):(args=(methodName=etherOut?useFeeOnTransfer?"swapExactTokensForETHSupportingFeeOnTransferTokens":"swapExactTokensForETH":useFeeOnTransfer?"swapExactTokensForTokensSupportingFeeOnTransferTokens":"swapExactTokensForTokens",[amountIn,amountOut,path,to,deadline]),ZERO_HEX);break;case exports.TradeType.EXACT_OUTPUT:useFeeOnTransfer&&invariant(!1,"EXACT_OUT_FOT"),value=etherIn?(methodName="swapETHForExactTokens",args=[amountOut,path,to,deadline],amountIn):(args=(methodName=etherOut?"swapTokensForExactETH":"swapTokensForExactTokens",[amountOut,amountIn,path,to,deadline]),ZERO_HEX)}return{methodName:methodName,args:args,value:value}},Router}(),ERC20=[{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}],TOKEN_DECIMALS_CACHE=((_TOKEN_DECIMALS_CACHE={})[exports.ChainId.MUMBAI]={"0xE0B7927c4aF23765Cb51314A0E0521A9645F0E2A":9},_TOKEN_DECIMALS_CACHE),Fetcher=function(){function Fetcher(){}return Fetcher.fetchTokenData=function(chainId,address,provider,symbol,name){try{var _TOKEN_DECIMALS_CACHE2,_TOKEN_DECIMALS_CACHE3,_temp3=function(parsedDecimals){return new Token(chainId,address,parsedDecimals,symbol,name)},_temp4=(void 0===provider&&(provider=providers.getDefaultProvider(networks.getNetwork(chainId))),"number"==typeof(null==(_TOKEN_DECIMALS_CACHE2=TOKEN_DECIMALS_CACHE)||null==(_TOKEN_DECIMALS_CACHE3=_TOKEN_DECIMALS_CACHE2[chainId])?void 0:_TOKEN_DECIMALS_CACHE3[address]));return Promise.resolve(_temp4?_temp3(TOKEN_DECIMALS_CACHE[chainId][address]):Promise.resolve(new contracts.Contract(address,ERC20,provider).decimals().then(function(decimals){var _TOKEN_DECIMALS_CACHE4,_extends3;return TOKEN_DECIMALS_CACHE=_extends({},TOKEN_DECIMALS_CACHE,((_extends3={})[chainId]=_extends({},null==(_TOKEN_DECIMALS_CACHE4=TOKEN_DECIMALS_CACHE)?void 0:_TOKEN_DECIMALS_CACHE4[chainId],((_TOKEN_DECIMALS_CACHE4={})[address]=decimals,_TOKEN_DECIMALS_CACHE4)),_extends3)),decimals})).then(_temp3))}catch(e){return Promise.reject(e)}},Fetcher.fetchPairData=function(tokenA,tokenB,provider){try{void 0===provider&&(provider=providers.getDefaultProvider(networks.getNetwork(tokenA.chainId))),tokenA.chainId!==tokenB.chainId&&invariant(!1,"CHAIN_ID");var address=Pair.getAddress(tokenA,tokenB);return Promise.resolve(new contracts.Contract(address,IUniswapV2Pair.abi,provider).getReserves()).then(function(_ref){var reserves0=_ref[0],_ref=_ref[1],_ref=tokenA.sortsBefore(tokenB)?[reserves0,_ref]:[_ref,reserves0];return new Pair(new TokenAmount(tokenA,_ref[0]),new TokenAmount(tokenB,_ref[1]))})}catch(e){return Promise.reject(e)}},Fetcher}();exports.JSBI=JSBI,exports.Currency=Currency,exports.CurrencyAmount=CurrencyAmount,exports.ETHER=ETHER,exports.FACTORY_ADDRESS=FACTORY_ADDRESS,exports.Fetcher=Fetcher,exports.Fraction=Fraction,exports.INIT_CODE_HASH=INIT_CODE_HASH,exports.InsufficientInputAmountError=InsufficientInputAmountError,exports.InsufficientReservesError=InsufficientReservesError,exports.MINIMUM_LIQUIDITY=MINIMUM_LIQUIDITY,exports.Pair=Pair,exports.Percent=Percent,exports.Price=Price,exports.Route=Route,exports.Router=Router,exports.Token=Token,exports.TokenAmount=TokenAmount,exports.Trade=Trade,exports.WETH=WETH,exports.currencyEquals=currencyEquals,exports.inputOutputComparator=inputOutputComparator,exports.tradeComparator=tradeComparator;